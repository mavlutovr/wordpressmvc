# Как настроить отправку писем



## Как указать ящики для уведомлений?

Это те ящики, на которые приходят письма с сайта (администраторские ящики) . Например, при заполнении формы обратной связи.

:arrow_right: Админка - Настройки - Контакты для уведомлений



## Как настроить SMTP?

Чтобы письма меньше попадали в спам и доставлялись с большей вероятностью.

:arrow_right: Админка - Настройки - Настройка отправки писем - SMTP

#### Как проверить отправку писем?

:arrow_right: Админка - Настройки - Отправка тестового письма



## Как настроить отправку писем через Cron?

Это бывает полезно, когда работает отправка писем через SMTP. Которая работает медленнее.

Чтобы ваши посетители не ждали, когда же у них отправится форма и перезагрузится страница. Письмо отправляется позже с помощью этой функции.

:arrow_right: Админка - Настройки - Настройка отправки писем - Cron



## Как отправлять письма?

С помощью функции wdpro_mail, которая отправляет письма так же как и wp_mail, только в формате html:

```php
wdpro_mail(
    'Тема',
    '<p>Сообщение</p>',
    $headers,
    $attachments
);
```

А так вы можете быстро отправить сообщение на все ящики для уведомлений (администраторские ящики).:

```php
\Wdpro\AdminNotice\Controller::sendMessageHtml(
    'Тема письма',
    '<p>Сообщение</p>'
);
```



## Как сделать шаблон писем?

Чтобы сообщения, рассылаемые сайтом можно было редактировать из админки.

##### Сначала подключите модуль e-mail шаблонов:

```php
Wdpro\Modules::addWdpro('sender/templates/email');
```

##### Создайте шаблон письма:

:arrow_right: Админка - Настройки - Шаблоны писем - Добавить шаблон

В тексте шаблона укажите шорткоды `[shortcode_name]`, которые заменятся на данные шаблона.

##### Пропишите код, который отправляет письмо по шаблону:

```php
\Wdpro\Sender\Templates\Email\Controller::send(
    
    // Имя шаблона
    'test',
    
    // Ящик(и), куда отправить письмо
    'name@site.ru'
    
    // Данные для шаблона
    $data
);
```

##### Или на админские ящики:

```php
\Wdpro\Sender\Templates\Email\Controller::send(
    
    // Имя шаблона
    'test',
    
    // Ящик(и), куда отправить письмо
    \Wdpro\AdminNotice\Controller::getAdminEmails(),
    
    // Данные для шаблона
    $data
);
```


##### Как добавлять свои данные во все шаблоны

Когда, например, вы хотите во все шаблоны отправить подпись.

Вы можете это сделать с помощью фильтра обработки данных шаблона:

```php
add_filter('wdpro_sender_templates_email_data', function ($templateData) {

    // Добавляем в данные шаблона подпись
    $templateData['signature'] = '<p>С уважением...</p>';

    return $templateData;
});
```

После чего вы можете добавить в текст шаблона шорткод [signature]. Который поменяется на подпись.